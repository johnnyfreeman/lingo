(function(){var t,r,n,e,u;u=require("restify"),r=u.createServer({name:"Lingo API"}),e=require("rethinkdb"),t=require("q"),r.listen(81,function(){return console.log("%s listening at %s",r.name,r.url)}),t.longStackSupport=!0,n=null,e.connect({host:"localhost",port:28015,db:"lingo"},function(t,r){if(t)throw t;return n=r}),r.use(u.bodyParser()),r.get("/phrases",function(t,r,u){return e.table("phrases").run(n,function(t,n){if(t)throw t;return n.toArray(function(t,n){if(t)throw t;return r.send(n),u()})})}),r.post("/phrases",function(t,r,i){return"undefined"===t.params.title?i(new u.InvalidArgumentError("Title must be supplied")):e.table("phrases").insert(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),i()})}),r.get("/phrase/:id",function(t,r,u){return e.table("phrases").get(t.params.id).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.put("/phrase/:id",function(t,r,u){var i;return i=t.params.id,delete t.params.id,e.table("phrases").get(t.params.id).update(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.get("/tags",function(t,r,u){return e.table("tags").run(n,function(t,n){if(t)throw t;return n.toArray(function(t,n){if(t)throw t;return r.send(n),u()})})}),r.post("/tags",function(t,r,i){return"undefined"===t.params.title?i(new u.InvalidArgumentError("Title must be supplied")):e.table("tags").insert(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),i()})}),r.get("/tag/:id",function(t,r,u){return e.table("tags").get(t.params.id).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.put("/tag/:id",function(t,r,u){var i;return i=t.params.id,delete t.params.id,e.table("tags").get(t.params.id).update(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.get("/users",function(t,r,u){return e.table("users").run(n,function(t,n){if(t)throw t;return n.toArray(function(t,n){if(t)throw t;return r.send(n),u()})})}),r.post("/users",function(t,r,i){return"undefined"===t.params.title?i(new u.InvalidArgumentError("Title must be supplied")):e.table("users").insert(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),i()})}),r.get("/user/:id",function(t,r,u){return e.table("users").get(t.params.id).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.get("/user/:id/phrases",function(t,r,u){var i,s;return i="phrases",s=t.params.id,e.table("users").get(s).run(n,function(t,a){if(t)throw t;return e.table(i).getAll(s,{index:"createdBy"}).run(n,function(t,n){if(t)throw t;return n.toArray(function(t,n){if(t)throw t;return a[i]=n,r.send(a),u()})})})}),r.put("/user/:id",function(t,r,u){var i;return i=t.params.id,delete t.params.id,e.table("users").get(t.params.id).update(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.get("/settings",function(t,r,u){return e.table("settings").run(n,function(t,n){if(t)throw t;return n.toArray(function(t,n){if(t)throw t;return r.send(n),u()})})}),r.post("/settings",function(t,r,i){return"undefined"===t.params.title?i(new u.InvalidArgumentError("Title must be supplied")):e.table("settings").insert(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),i()})}),r.get("/setting/:id",function(t,r,u){return e.table("settings").get(t.params.id).run(n,function(t,n){if(t)throw t;return r.send(n),u()})}),r.put("/setting/:id",function(t,r,u){var i;return i=t.params.id,delete t.params.id,e.table("settings").get(t.params.id).update(t.params).run(n,function(t,n){if(t)throw t;return r.send(n),u()})})}).call(this);